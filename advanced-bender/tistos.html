
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>TisTos-family of methods Â· GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        <meta name="author" content="The Starterkit team and contributors">
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-panels/panels.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-katex-auto-render/katex.min.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="tools.html" />
    
    
    <link rel="prev" href="fill.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    The bender tutorials
            
                </a>
            

            
        </li>
    

    
        
        <li class="divider"></li>
        
        
    
        <li class="chapter " data-level="2.1" data-path="../getting-started/">
            
                <a href="../getting-started/">
            
                    
                    Getting started
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.1.1" data-path="../getting-started/twouseless.html">
            
                <a href="../getting-started/twouseless.html">
            
                    
                    The first two (almost useless) examples
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.2" data-path="../getting-started/firstalgorithms.html">
            
                <a href="../getting-started/firstalgorithms.html">
            
                    
                    The first algorithms
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.3" data-path="../getting-started/createcompounds.html">
            
                <a href="../getting-started/createcompounds.html">
            
                    
                    Loops & compounds
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="divider"></li>
        
        
    
        <li class="chapter " data-level="3.1" data-path="./">
            
                <a href="./">
            
                    
                    Advanced Bender
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.1.1" data-path="fill.html">
            
                <a href="fill.html">
            
                    
                    Fill-family of methods
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="3.1.2" data-path="tistos.html">
            
                <a href="tistos.html">
            
                    
                    TisTos-family of methods
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.3" data-path="tools.html">
            
                <a href="tools.html">
            
                    
                    Using tools
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="divider"></li>
        
        
    
        <li class="chapter " data-level="4.1" data-path="../simulation/">
            
                <a href="../simulation/">
            
                    
                    Bender & simulation 
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.1.1" data-path="../simulation/mctruth.html">
            
                <a href="../simulation/mctruth.html">
            
                    
                    MC truth
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.1.2" data-path="../simulation/mcmatch.html">
            
                <a href="../simulation/mcmatch.html">
            
                    
                    MC match
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.1.3" data-path="../simulation/hepmc.html">
            
                <a href="../simulation/hepmc.html">
            
                    
                    processing of HepMC
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="divider"></li>
        
        
    
        <li class="chapter " data-level="5.1" data-path="../ganga/">
            
                <a href="../ganga/">
            
                    
                     Bender & Ganga
            
                </a>
            

            
        </li>
    

    
        
        <li class="divider"></li>
        
        
    
        <li class="chapter " data-level="6.1" data-path="../CONTRIBUTING.html">
            
                <a href="../CONTRIBUTING.html">
            
                    
                    Contributing
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.2" data-path="../getting-started/formatting-examples.html">
            
                <a href="../getting-started/formatting-examples.html">
            
                    
                    Examples of formatting
            
                </a>
            

            
        </li>
    

    
        
        <li class="divider"></li>
        
        
    
        <li class="chapter " data-level="7.1" >
            
                <a target="_blank" href="ref://bender-tutorials.pdf">
            
                    
                    Download PDF
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >TisTos-family of methods</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="handling-of-tistos-information-in-bender--bendertoolstistos-module">Handling of <code>TisTos</code> information in Bender  (<code>BenderTools.TisTos</code> module)</h1>
<p>Bender offers set of methods to handle <code>TisTos</code>-information in (relatively) easy way.
This functionality  comes from <code>BenderTools.TisTos</code> module.
In short, it adds three relates method in the base class <code>Algo</code>:</p>
<table>
<thead>
<tr>
<th>Method</th>
<th>Short description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>decisions</code></td>
<td>collect the trigger decisions for the given particle</td>
</tr>
<tr>
<td><code>trgDecs</code></td>
<td>print the collected trigger statistics in readable way</td>
</tr>
<tr>
<td><code>tisTos</code></td>
<td>fill N-tuple with <code>TisTos</code>-information</td>
</tr>
</tbody>
</table>
<p>All of them are (relatively well) documented and one can easily inspect them:</p>
<pre><code class="lang-python"><span class="hljs-keyword">import</span> BenderTools.TisTos
<span class="hljs-keyword">from</span> Bender.Main <span class="hljs-keyword">import</span> Algo
help(Algo.decisions)
</code></pre>
<h2 id="how-to-know-what-trigger-lines-are-relevant-or-the-given-decayparticle">How to know what trigger lines are relevant or the given decay/particle?</h2>
<p>Often information about the releavant trigger lines are spread in corridors 
in a form of myths, general beliefs or, in the best case, references to ANA-notes 
for some similar analysis. However it is very simple to collect 
this infomation using Bender. The method <code>decisions</code> is our friend here. 
the usage of  this method require some preparatory work for the algorithm, 
namely one needs to instrument <code>initialize</code>-method:</p>
<pre><code class="lang-python"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TrgLines</span><span class="hljs-params">(Algo)</span>:</span>
    <span class="hljs-string">&quot;&quot;&quot;Collect infomation about the trigger lines relevant for certain decays/particles
    &quot;&quot;&quot;</span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">initialize</span> <span class="hljs-params">( self )</span> :</span>

        sc = Algo.initialize ( self ) <span class="hljs-comment">## initialize the base class</span>
        <span class="hljs-keyword">if</span> sc.isFailure() : <span class="hljs-keyword">return</span> sc

        <span class="hljs-comment">#</span>
        <span class="hljs-comment">## container to collect trigger information, e.g. list of fired lines </span>
        <span class="hljs-comment">#</span>
        triggers = {}
        triggers [<span class="hljs-string">&apos;psi&apos;</span>] = {} <span class="hljs-comment">## slot to keep the information for J/psi </span>
        triggers [<span class="hljs-string">&apos;K&apos;</span>]   = {} <span class="hljs-comment">## slot to keep the information for kaons  </span>
        triggers [<span class="hljs-string">&apos;B&apos;</span>]   = {} <span class="hljs-comment">## slot to keep the information for B-mesons </span>

        sc = self.tisTos_initialize ( triggers , lines = {} )
        <span class="hljs-keyword">if</span> sc.isFailure() : <span class="hljs-keyword">return</span> sc

        <span class="hljs-keyword">return</span> SUCCESS
</code></pre>
<p>Here in this example we want to collect <code>TisTos</code>-information 
for <code>J/psi</code>, <code>K</code> and the whole <code>B+</code>-meson. Then in the main <code>analyse</code>-method one just needs to invoke 
the method <code>decisions</code> for each particles  in interest:</p>
<pre><code class="lang-python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">analyse</span><span class="hljs-params">( self )</span> :</span>   <span class="hljs-comment">## IMPORTANT! </span>
  <span class="hljs-string">&quot;&quot;&quot;The main &apos;analysis&apos; method &quot;&quot;&quot;</span>
  ...         
  <span class="hljs-keyword">for</span> b <span class="hljs-keyword">in</span> particles :

      psi =b(<span class="hljs-number">1</span>) <span class="hljs-comment">## the first  daughter: J/psi </span>
      k   =b(<span class="hljs-number">2</span>) <span class="hljs-comment">## the second daughter: K </span>

      <span class="hljs-comment">## collect trigger information for J/psi </span>
      self.decisions   ( psi , self.triggers[<span class="hljs-string">&apos;psi&apos;</span>] )

      <span class="hljs-comment">## collect trigger information for kaons </span>
      self.decisions   ( k   , self.triggers[<span class="hljs-string">&apos;K&apos;</span>]   )

      <span class="hljs-comment">## collect trigger information for B-mesons </span>
      self.decisions   ( b   , self.triggers[<span class="hljs-string">&apos;B&apos;</span>]   ) 

  ...     
  <span class="hljs-keyword">return</span> SUCCESS
</code></pre>
<p>Thats all. Then when jobs runs  it dumps to the log-file the running trigger statistics, 
and the statistics is dumped into the file <code>TrgLines_tistos.txt</code> (<code>&lt;ALGNAME&gt;_tistos.txt</code> in general).
The summary table looks like:</p>
<pre><code>******************************************************************************************
 Triggers for  psi
******************************************************************************************
Hlt1_TIS psi   #lines:     7 #events 321   
 (  0.62 +- 0.44 )       Hlt1DiMuonHighMassDecision 
 (  0.62 +- 0.44 )       Hlt1DiMuonLowMassDecision 
 ( 19.00 +- 2.19 )       Hlt1TrackAllL0Decision 
 (  3.74 +- 1.06 )       Hlt1TrackAllL0TightDecision 
 (  4.36 +- 1.14 )       Hlt1TrackMuonDecision 
 (  0.93 +- 0.54 )       Hlt1TrackPhotonDecision 
 (  0.31 +- 0.31 )       Hlt1VertexDisplVertexDecision 
 (100.00 +- 0.31 )       TOTAL 
Hlt1_TOS psi   #lines:     9 #events 321   
 ( 72.90 +- 2.48 )       Hlt1DiMuonHighMassDecision 
 ( 59.81 +- 2.74 )       Hlt1DiMuonLowMassDecision 
 (  0.31 +- 0.31 )       Hlt1DiProtonDecision 
 (  9.03 +- 1.60 )       Hlt1SingleMuonHighPTDecision 
 (  0.31 +- 0.31 )       Hlt1SingleMuonNoIPDecision 
 ( 44.24 +- 2.77 )       Hlt1TrackAllL0Decision 
 ( 10.90 +- 1.74 )       Hlt1TrackAllL0TightDecision 
 ( 74.77 +- 2.42 )       Hlt1TrackMuonDecision 
 (  0.31 +- 0.31 )       Hlt1TrackPhotonDecision 
 (100.00 +- 0.31 )       TOTAL 
Hlt1_TPS psi   #lines:     6 #events 321   
 ( 13.71 +- 1.92 )       Hlt1DiMuonHighMassDecision 
 ( 10.90 +- 1.74 )       Hlt1DiMuonLowMassDecision 
 (  0.31 +- 0.31 )       Hlt1DiProtonDecision 
 (  3.12 +- 0.97 )       Hlt1TrackAllL0Decision 
 (  0.93 +- 0.54 )       Hlt1TrackAllL0TightDecision 
 (  4.67 +- 1.18 )       Hlt1TrackMuonDecision 
 (100.00 +- 0.31 )       TOTAL
</code></pre><p>Only a short fragment is shown here, one gets similar fragments for all declared 
particles (<code>psi</code>, <code>K</code> and <code>B</code>) and for all trigger levels (<code>L0</code>, <code>Hlt1</code> and <code>Hlt2</code>).
The full table is accessible <a href="https://gist.github.com/VanyaBelyaev/90cc0f9b1ab84c8e40e2cd2ccf321bc3" target="_blank">here</a>
The content of the summaty table is rather intuitive: it summarizes the fire frequences for 
varios trugegr lines for three regimes <code>TIS</code>, <code>TOS</code> and <code>TPS</code>. 
Inspecting such table, one immediately concludes that the most relevan <code>Hlt1-TOS</code>-line
is <code>Hlt1DiMuonHighMassDecision</code>. Other <code>Hlt1-TOS</code>-lines are  less relevant here. 
But please note that here only very small statistics is used (321 event), 
and with larger statistics sthe conclusions could be corrected.
E.g. due to  small statistics here, for <code>Hlt1-TIS</code>-lines the choice is not evident:
one clearly see that <code>Hlt1TrackAllL0Decision</code> line is important, but for 
importance of other lines one csn judge only after the 
significant increase of the statistics.</p>
<p><div class="panel panel-success"><div class="panel-heading"><h3 class="panel-title" onclick="javascript:toggle(9087762708);" id="what-is-tistosdb-fileclick-to-expand"><i class="fa fa-bell"></i> What is `<algname>_tistos.db` file?<span id="heading-9087762708">Click to expand</span></algname></h3></div><div class="panel-body" style="display: none" id="panel-9087762708"><p>In practice to make a decision, large statistics is required (for real data and/or for simulated samples).
And here these files are very useful. 
The trigger statistics is  saved not only in <code>&lt;ALGNAME&gt;_tistos.txt</code>-file but also in <code>shelve</code>-dbase 
<code>&lt;ALGNAME&gt;_tistos.db</code>.<br>If really large statistics is required there are some utilities to merge the 
information from these <code>&lt;ALGNAME&gt;_tistos.db</code> together, e.g. on the output of Ganga jobs.</p>
</div></div></p>
<p><div class="panel panel-success"><div class="panel-heading"><h3 class="panel-title" onclick="javascript:toggle(1512820638);" id="challenge"><i class="fa fa-square-o"></i> Challenge<span id="heading-1512820638"></span></h3></div><div class="panel-body" id="panel-1512820638"><ol>
<li>Add <code>decisions</code>-function for your previous Bender module with n-tuples. <ul>
<li>(Do not  forget to instrument the <code>initialize</code> method)</li>
</ul>
</li>
<li>Run it and observe the output summary table </li>
<li>Identify the relevant  <code>L0-TOS</code>, <code>Hlt1-TOS</code> and <code>Hlt2-TOS</code> lines for your decay <ul>
<li>Does it correspond to your  expectations?</li>
</ul>
</li>
</ol>
<div class="panel panel-danger"><div class="panel-heading"><h3 class="panel-title" onclick="javascript:toggle(9663594688);" id="solution"><i class="fa fa-line-chart"></i> Solution<span id="heading-9663594688"></span></h3></div><div class="panel-body" id="panel-9663594688"><p>The complete module is accessible <a href="https://gist.github.com/VanyaBelyaev/0e12d07b705dcd4af48aea8dad02f727" target="_blank">here</a>
and the corresponsing summary table is <a href="https://gist.github.com/VanyaBelyaev/90cc0f9b1ab84c8e40e2cd2ccf321bc3" target="_blank">here</a></p>
</div></div></div></div></p>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="fill.html" class="navigation navigation-prev " aria-label="Previous page: Fill-family of methods">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="tools.html" class="navigation navigation-next " aria-label="Next page: Using tools">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"TisTos-family of methods","level":"3.1.2","depth":2,"next":{"title":"Using tools","level":"3.1.3","depth":2,"path":"advanced-bender/tools.md","ref":"advanced-bender/tools.md","articles":[]},"previous":{"title":"Fill-family of methods","level":"3.1.1","depth":2,"path":"advanced-bender/fill.md","ref":"advanced-bender/fill.md","articles":[]},"dir":"ltr"},"config":{"plugins":["-sharing","panels@git+https://github.com/lhcb/gitbook-plugin-panels.git#master","katex-auto-render@git+https://github.com/lhcb/gitbook-plugin-katex-auto-render.git#master","collapsible-menu","otherlink"],"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"collapsible-menu":{},"search":{},"otherlink":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"panels":{},"fontsettings":{"theme":"white","family":"sans","size":2},"highlight":{},"katex-auto-render":{},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"theme":"default","author":"The Starterkit team and contributors","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"gitbook":"*"},"file":{"path":"advanced-bender/tistos.md","mtime":"2018-03-03T14:07:25.731Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2018-03-03T14:12:42.615Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-panels/panels.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-katex-auto-render/katex.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-katex-auto-render/auto-render.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-katex-auto-render/enable-auto-render.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-collapsible-menu/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-otherlink/js/otherlink.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

